ggsave(file=paste(sep="",wd,"/",myNames[1],"_",myNames[[org]],"scatterplot.svg"), plot=finale, width=5, height=5)
finale = sp + geom_point(alpha=.5,position = "jitter") + ggtitle(paste("Scatterplot of L-SAAR length differences and SP length differences\n",myNames[[1]]," vs.", myNames[org] )) + theme(plot.title = element_text(hjust = 0.5))
ggsave(file=paste(sep="",wd,"/",myNames[1],"_",myNames[[org]],"_scatterplot.svg"), plot=finale, width=5, height=5)
ggsave(file=paste(sep="",wd,"/",myNames[1],"_",myNames[[org]],"_scatterplot.svg"), plot=finale, width=10, height=10)
dir.create(path = paste(wd,sep = "/","length_analysis_plots")
)
dir.create(path = paste(wd,sep = "/","length_analysis_plots"))
dir.exists(path = paste(wd,sep = "/","length_analysis_plots"))
library(dplyr)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
class(file)
file$ENSMMUP00000000007
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
file$ORGANISM
dplyr::filter(file,ORGANISM == grepl("^ENSBTA",perl = T))
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
dplyr::filter(file,ORGANISM == grepl("^ENSBTA",perl = T))
dplyr::filter(file,grepl("^ENSBTA",perl = T,ORGANISM))
a = dplyr::filter(file,grepl("^ENSBTA",perl = T,ORGANISM))
file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM))
file$seqORGANISM[11]
gprel("EEEE",file$seqORGANISM[11])
grepl("EEEE",file$seqORGANISM[11])
grepl("EEEEE",file$seqORGANISM[11])
file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(grepl("LLLLL",perl = T,seqORGANISM))
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(grepl("LLLLL",perl = T,seqORGANISM))
rm(a)
length(filtered$seqOOI[11])
## try http:// if https:// URLs are not supported
source("https://bioconductor.org/biocLite.R")
biocLite("Biostrings")
library(Biostrings)
length(s2c(filtered$seqOOI[11]))
install.packages("seqinr")
library("seqinr", lib.loc="~/R/x86_64-pc-linux-gnu-library/3.4")
length(s2c(filtered$seqOOI[11]))
(s2c(filtered$seqOOI[11])
)
(s2c(filtered$seqORGANISM[11]))
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
(s2c(filtered$seqORGANISM[11]))
(s2c(filtered$seqORGANISM[25]))
(s2c(filtered$seqORGANISM[111]))
dim(filtered)
filtered[1,1]
filtered[1,4]
filtered$seqOOI
(s2c(filtered$seqOOI[251]))
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = dim(filtered)[1],ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = filtered[c,1]
output[c,3] = filtered[c,3]
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
View(output)
dim(filtered)[1]
output = matrix(data = NA,nrow = dim(filtered)[1],ncol = 4)
View(output)
output = matrix(data = NA,nrow = 100000000,ncol = 4)
output = matrix(data = NA,nrow = 100000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = filtered[c,1]
output[c,3] = filtered[c,3]
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
output = matrix(data = NA,nrow = 100000,ncol = 4)
output[1,1]
filtered[c,3]
unlist(filtered[c,3])
unlist(filtered[c,3])
output = matrix(data = NA,nrow = 100000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[c,1])
output[c,3] = unlist(filtered[c,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
View(output)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 100000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
View(output)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
View(output)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("gallus_gallus","xenopus_tropicalis")
for(o in nonmammals){
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
readr::write_csv(output,path = "/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
View(output)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXE")
for(o in nonmammals){
filtered = file %>% filter(grepl("^ENSBTA",perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
readr::write_csv(output,path = "/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXE")
for(o in nonmammals){
str = paste("^",o)
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
readr::write_csv(output,path = "/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXE")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
readr::write_csv(output,path = "/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXE")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,path = "/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXE")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSGAL","ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 25000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 2500000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,"/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/test.csv")
}
library(dplyr)
library(Biostrings)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",o,".csv"))
}
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET","ENSGAL")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",o,".csv"))
}
library(dplyr)
library(Biostrings)
file = readr::read_csv("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/macaca_mulatta_prepared_sequence_comparison.csv")
nonmammals = c("ENSXET","ENSGAL")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",o,".csv",sep = ""))
}
mammals = c("macaca_mulatta","homo_sapiens","pan_troglodytes","mus_musculus","gorilla_gorilla","rattus_norvegicus")
for(m in mammals){
file = readr::read_csv(paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/",mammals,"_prepared_sequence_comparison.csv",sep=""))
nonmammals = c("ENSXET","ENSGAL")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",m,"_",o,".csv",sep = ""))
}
}
mammals = c("macaca_mulatta","homo_sapiens","pan_troglodytes","mus_musculus","gorilla_gorilla","rattus_norvegicus")
for(m in mammals){
file = readr::read_csv(paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/",m,"_prepared_sequence_comparison.csv",sep=""))
nonmammals = c("ENSXET","ENSGAL")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",m,"_",o,".csv",sep = ""))
}
}
mammals = c("macaca_mulatta","homo_sapiens","pan_troglodytes","mus_musculus","gorilla_gorilla","rattus_norvegicus")
for(m in mammals){
file = readr::read_csv(paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/",m,"_prepared_sequence_comparison.csv",sep=""))
nonmammals = c("ENSXET","ENSGAL")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",m,"_",o,".csv",sep = ""))
}
}
library(dplyr)
library(Biostrings)
mammals = c("macaca_mulatta","homo_sapiens","pan_troglodytes","mus_musculus","gorilla_gorilla","rattus_norvegicus")
for(m in mammals){
print(m)
file = readr::read_csv(paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/snakemake/snakemake/",m,"_prepared_sequence_comparison.csv",sep=""))
nonmammals = c("ENSXET","ENSGAL")
for(o in nonmammals){
str = paste("^",o,sep = "")
print(str)
filtered = file %>% filter(grepl(str,perl = T,ORGANISM)) %>% filter(!grepl("LLLLL",perl = T,seqORGANISM))
output = matrix(data = NA,nrow = 250000,ncol = 4)
colnames(output) = c("MAMMAL","AA","NONMAMMAL_ORTHO","AA")
c = 1
for(i in seq(1,dim(filtered)[1])){
for(j in seq(1,length(s2c(filtered$seqOOI[i])))){
output[c,1] = unlist(filtered[i,1])
output[c,3] = unlist(filtered[i,3])
output[c,2] = s2c(filtered$seqOOI[i])[j]
output[c,4] = s2c(filtered$seqORGANISM[i])[j]
c=c+1
}
}
write.csv(output,paste("/home/mstolarczyk/Uczelnia/MGR/praca_magisterska/dla_czecha/",m,"_",o,".csv",sep = ""))
}
}
